function Search-File {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory = $true, HelpMessage = "Enter the path for the file to search.")]
        [string]$FilePath,
        [Parameter(Mandatory = $true)]
        [string]$PatternMatch,
        [Parameter(Mandatory = $false)]
        [string]$count
    )


# Step 1: Validate input
# 1) Resolve the path (throws an error if the file is not found)
try {
    $resolved = Resolve-Path -LiteralPath $FilePath -ErrorAction Stop
} catch {
    Write-Error "File not found: $FilePath. $($_.Exception.Message)"
    return
}

# 2) Get the item (throws if access is denied / other I/O errors)
try {
    $item = Get-Item -LiteralPath $resolved -ErrorAction Stop
} catch {
    Write-Error "Cannot access file: $resolved. $($_.Exception.Message)"
    return
}

# 3) Check that it's a file, not a directory
if ($item.PSIsContainer) {
    Write-Error "The specified path is a directory; a file is required: $resolved"
    return
}

$results = Get-Content -Path $filepath | Select-String -Pattern $PatternMatch

if ($PSBoundParameters.ContainsKey('Count')) {
                            Write-Host "Count: $($results.count)"
    }else {
        Write-Output $results
    }
}
